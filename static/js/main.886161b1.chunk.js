(this["webpackJsonpmicropayments-platform"]=this["webpackJsonpmicropayments-platform"]||[]).push([[0],{142:function(e){e.exports=JSON.parse('{"a":[{"inputs":[{"internalType":"string","name":"_name","type":"string"}],"stateMutability":"payable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"uint256","name":"at","type":"uint256"}],"name":"PaymentClaimed","type":"event"},{"inputs":[],"name":"factory","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"claimPayment","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"shutdown","outputs":[],"stateMutability":"nonpayable","type":"function"}]}')},186:function(e){e.exports=JSON.parse('{"a":[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"location","type":"address"},{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"uint256","name":"createdAt","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"MicropaymentsCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"location","type":"address"}],"name":"MicropaymentsDeleted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"contracts","outputs":[{"internalType":"contract Micropayments","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"name","type":"string"}],"name":"createMicropayment","outputs":[],"stateMutability":"payable","type":"function","payable":true},{"inputs":[],"name":"getMicropaymentsContracts","outputs":[{"components":[{"internalType":"address","name":"location","type":"address"},{"internalType":"string","name":"name","type":"string"}],"internalType":"struct MicropaymentsFactory.MicropaymentData[]","name":"_contracts","type":"tuple[]"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"string","name":"name","type":"string"}],"name":"getMicropaymentsContractAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[{"internalType":"address","name":"location","type":"address"}],"name":"deleteContract","outputs":[],"stateMutability":"nonpayable","type":"function"}],"b":{"4":{"events":{"0x0b42296e41ce278a9dcd91e4d5490472056339c7779b5c0d3f5e9706af735d44":{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"location","type":"address"},{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"uint256","name":"createdAt","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"MicropaymentsCreated","type":"event"},"0xb84299a14bbfe4d2d0b71eab16c82f356c8489fa2cbf3c1993eef272d5e2681a":{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"location","type":"address"}],"name":"MicropaymentsDeleted","type":"event"},"0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0":{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"}},"links":{},"address":"0x140E2Dc060148ee909A793123e2B13a1F3c62b24","transactionHash":"0x0ebaad9e5f0728f22dd5c5f5708d81a1d44c9af9e2abeed3005ddf8042afb953"},"5777":{"events":{"0x0b42296e41ce278a9dcd91e4d5490472056339c7779b5c0d3f5e9706af735d44":{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"location","type":"address"},{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"uint256","name":"createdAt","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"MicropaymentsCreated","type":"event"},"0xb84299a14bbfe4d2d0b71eab16c82f356c8489fa2cbf3c1993eef272d5e2681a":{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"location","type":"address"}],"name":"MicropaymentsDeleted","type":"event"},"0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0":{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"}},"links":{},"address":"0x81161C22400251418D74A4f555636B90C76991aA","transactionHash":"0x1a8cf42da5c1205ed61271addd2c07a1d1022e189277762b4544813086218d82"}}}')},288:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},317:function(e,t){},319:function(e,t){},321:function(e,t){},327:function(e,t){},353:function(e,t){},355:function(e,t){},369:function(e,t){},371:function(e,t){},408:function(e,t){},410:function(e,t){},515:function(e,t){},516:function(e,t){},614:function(e,t,n){},615:function(e,t,n){},616:function(e,t,n){},617:function(e,t,n){},626:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(48),s=n.n(c),i=(n(304),n(297)),o=n(16),d=(n(305),n(643)),u=n(633),l=n(642),j=n(634),p=n(291),b=n(635),m=(n(306),n.p+"static/media/ethereum-logo.b3ec96d9.svg"),f=n(1),h=function(){return Object(f.jsxs)("div",{id:"home",children:[Object(f.jsx)(d.a,{bg:"primary",expand:"lg",className:"navbar",fixed:"top",children:Object(f.jsxs)(u.a,{children:[Object(f.jsx)(d.a.Brand,{href:"#",children:"Micropayments Factory"}),Object(f.jsx)(d.a.Toggle,{"aria-controls":"navbarScroll"}),Object(f.jsx)(d.a.Collapse,{id:"navbarScroll",className:"justify-content-end",children:Object(f.jsxs)(l.a,{children:[Object(f.jsx)(l.a.Link,{href:"#/company",children:"Company"}),Object(f.jsx)(l.a.Link,{href:"#/contractor",children:"Contractor"})]})})]})}),Object(f.jsx)(u.a,{className:"content",children:Object(f.jsxs)(j.a,{children:[Object(f.jsx)(p.a,{children:Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Manage payments using this integrated platform."}),Object(f.jsx)("h4",{children:"Just create contracts and enable payments by delivering a signed message. Easy for you as employer or employee."})]})}),Object(f.jsx)(p.a,{children:Object(f.jsx)(b.a,{width:"150",src:m})})]})})]})},y=n(25),x=n(9),O=n(14),v=n.n(O),w=n(648),g=n(637),C=n(646),k=n(644),T=n(296),M=n(295),A=n(649),S=n(70),N=n(10),D=n(11),P=n(17),B=n(18),E=function(){function e(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";Object(N.a)(this,e),this.contractInstance=void 0,this.userAccount=void 0,this.instanceAddress=void 0,this.contractInstance=new t.eth.Contract(n,a),this.userAccount=r,this.instanceAddress=a}return Object(D.a)(e,[{key:"updateUserAccount",value:function(e){this.userAccount=e}},{key:"isOwner",value:function(){var e=Object(y.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contractInstance.methods.owner().call({from:t});case 2:return n=e.sent,e.abrupt("return",(null===n||void 0===n?void 0:n.toLocaleUpperCase())===(null===t||void 0===t?void 0:t.toLocaleUpperCase()));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),I=function(e){Object(P.a)(n,e);var t=Object(B.a)(n);function n(){return Object(N.a)(this,n),t.apply(this,arguments)}return Object(D.a)(n,[{key:"createMicropayment",value:function(){var e=Object(y.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contractInstance.methods.createMicropayment(t).send({from:this.userAccount,value:n}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMicropaymentsContracts",value:function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contractInstance.methods.getMicropaymentsContracts().call({from:this.userAccount}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMicropaymentsContractAddress",value:function(){var e=Object(y.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contractInstance.methods.getMicropaymentsContractAddress(t).call({from:this.userAccount}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateUserAccount",value:function(e){this.userAccount=e}},{key:"deleteContract",value:function(e){return this.contractInstance.methods.deleteContract(e).send({from:this.userAccount})}},{key:"onMicropaymentsCreated",value:function(e,t){var n={};e&&(n={from:e}),this.contractInstance.events.MicropaymentsCreated({filter:n}).on("data",t)}},{key:"offMicropaymentsCreated",value:function(e,t){var n={};e&&(n={from:e}),this.contractInstance.events.MicropaymentsCreated({filter:n}).off("data",t)}}]),n}(E),L=function(e,t,n){var r=Object(a.useState)(new I(e,t,n));return Object(x.a)(r,1)[0]},H=n(292),F=n.n(H),_=function(){var e=Object(a.useState)(""),t=Object(x.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(new F.a(window.ethereum)),s=Object(x.a)(c,1)[0],i=function(){var e=Object(y.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.eth.requestAccounts();case 2:t=e.sent,r(t.length?t[0]:"");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=function(){var e=Object(y.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.eth.getAccounts();case 2:if((t=e.sent).length){e.next=5;break}return e.abrupt("return");case 5:r(t[0]);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s&&(s.currentProvider.on("accountsChanged",(function(e){r(e.length?e[0]:"")})),e())}),[s]),{web3:s,account:n,connectToMetaMask:i}},q=n(186),U=q.b[4].address,J=r.a.createContext(void 0),W=r.a.createContext(void 0),Y=r.a.createContext(""),z=function(e){var t=_(),n=t.web3,a=t.account,r=t.connectToMetaMask,c=L(n,q.a,U);return Object(f.jsx)(Y.Provider,{value:a,children:Object(f.jsx)(W.Provider,{value:r,children:Object(f.jsx)(J.Provider,{value:c,children:e.children})})})};function G(){var e=r.a.useContext(W);if(void 0===e)throw new Error("useMetaMask must be used within an SmartContractContextProvider");return e}function K(){var e=r.a.useContext(Y);if(void 0===e)throw new Error("useAccount must be used within an SmartContractContextProvider");return e}n(614);var R=n.p+"static/media/metamask.09e5f554.svg",V=(n(615),function(){return Object(f.jsx)("img",{src:R,id:"metamask-icon",alt:"MetaMask"})}),Q=function(e){Object(P.a)(n,e);var t=Object(B.a)(n);function n(){return Object(N.a)(this,n),t.apply(this,arguments)}return Object(D.a)(n,[{key:"claimPayment",value:function(){var e=Object(y.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contractInstance.methods.claimPayment(t,n,a).send({from:this.userAccount}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getBalance",value:function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.contractInstance.methods.getBalance().call({from:this.userAccount}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onPaymentClaimed",value:function(e,t){var n={};e&&(n={from:e}),this.contractInstance.events.PaymentClaimed({filter:n}).on("data",t)}},{key:"offPaymentClaimed",value:function(e,t){var n={};e&&(n={from:e}),this.contractInstance.events.PaymentClaimed({filter:n}).off("data",t)}}]),n}(E),X=n(142),Z=n(638),$=function(e){return Object(f.jsxs)(g.a,{type:e.type,children:[e.showLoader?Object(f.jsx)(Z.a,{animation:"border",as:"span",size:"sm"}):null,e.children]})};$.defaultProps={type:"button"};var ee,te=$;!function(e){e.Locked="Locked",e.Connected="Connected"}(ee||(ee={}));var ne,ae=function(){var e=Object(a.useState)("0"),t=Object(x.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(ee.Locked),s=Object(x.a)(c,2),i=s[0],o=s[1],d=Object(a.useState)(!1),l=Object(x.a)(d,2),b=l[0],m=l[1],h=Object(a.useState)(!1),O=Object(x.a)(h,2),N=O[0],D=O[1],P=G(),B=K(),E=_().web3;Object(a.useEffect)((function(){var e=function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=3;break}return o(ee.Locked),e.abrupt("return");case 3:o(ee.Connected);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[B]);var I=Object(a.useCallback)(Object(y.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.eth.getBalance(B);case 2:t=e.sent,r(Object(S.fromWei)(t));case 4:case"end":return e.stop()}}),e)}))),[B,E]);Object(a.useEffect)((function(){i===ee.Connected&&I()}),[i,I]);var L=function(){var e=Object(y.a)(v.a.mark((function e(t){var n,a,r,c,s,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function e(){I(),D(!1),m(!1),o.offPaymentClaimed(B,e)},t.preventDefault(),D(!0),a=Object.fromEntries(new FormData(t.target)),r=a.contractAddress,c=a.amount,s=a.nonce,i=a.signature,(o=new Q(E,X.a,r,B)).onPaymentClaimed(B,n),e.prev=6,e.next=9,o.claimPayment(Object(S.toWei)(c),s,i);case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(6),console.log(e.t0),n();case 15:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{id:"contractor",children:[Object(f.jsx)(u.a,{className:"content",children:Object(f.jsx)(j.a,{children:Object(f.jsx)(p.a,{children:Object(f.jsxs)(w.a,{className:"text-center",border:"dark",bg:"light",children:[Object(f.jsx)(w.a.Header,{children:"Your account's balance"}),Object(f.jsxs)(w.a.Title,{as:"h1",children:[n," ETH"]}),Object(f.jsx)(w.a.Subtitle,{className:"mb-2 text-muted",children:B}),Object(f.jsx)(w.a.Body,{className:"d-flex justify-content-center",children:i===ee.Connected?Object(f.jsx)(g.a,{variant:"secondary",onClick:function(){return m(!0)},children:"Claim a payment"}):Object(f.jsxs)(g.a,{variant:"secondary",className:"d-flex",onClick:P,children:[Object(f.jsx)(V,{}),Object(f.jsx)("div",{children:"Connect to MetaMask"})]})})]})})})}),Object(f.jsx)(C.a,{show:b,onHide:function(){return m(!1)},className:"contractor-modal",children:Object(f.jsxs)(k.a,{onSubmit:L,children:[Object(f.jsx)(C.a.Header,{closeButton:!0,children:Object(f.jsx)(C.a.Title,{children:"Claim your payment"})}),Object(f.jsxs)(C.a.Body,{children:[Object(f.jsx)(T.a,{label:"Contract Address",className:"mb-3",children:Object(f.jsx)(M.a,{name:"contractAddress",placeholder:"0x...",required:!0})}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(M.a,{name:"amount",placeholder:"0.0000"}),Object(f.jsx)(A.a.Text,{children:"ETH"})]}),Object(f.jsx)(A.a,{className:"mb-3",children:Object(f.jsx)(M.a,{name:"nonce",placeholder:"0"})}),Object(f.jsx)(T.a,{label:"Signature",className:"mb-3",children:Object(f.jsx)(M.a,{style:{minHeight:"150px",maxHeight:"250px"},as:"textarea",name:"signature",placeholder:"0x..."})})]}),Object(f.jsx)(C.a.Footer,{children:Object(f.jsx)(te,{type:"submit",showLoader:N,children:"\xa0Confirm\xa0"})})]})})]})},re=n(647),ce=n(51),se=(n(288),n(639)),ie=(n(616),function(e){return Object(f.jsx)("div",{id:"contracts-table",children:Object(f.jsxs)(se.a,{striped:!0,hover:!0,size:"sm",variant:"primary",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"#"}),Object(f.jsx)("th",{children:"Address"}),Object(f.jsx)("th",{children:"Name"})]})}),Object(f.jsx)("tbody",{children:e.contractData.map((function(t,n){return Object(f.jsxs)("tr",{onClick:function(){return e.rowSelectedCallback(t)},children:[Object(f.jsx)("td",{children:n}),Object(f.jsx)("td",{children:t.location}),Object(f.jsx)("td",{children:t.name})]},t.location)}))})]})})}),oe=n(140),de=n(645),ue=n(641),le=n(640),je=(n(617),n(23)),pe=n(187),be=function(){function e(t,n){Object(N.a)(this,e),this._web3=void 0,this._contractAddress=void 0,this._web3=t,this._contractAddress=n}return Object(D.a)(e,[{key:"signTransaction",value:function(){var e=Object(y.a)(v.a.mark((function e(t,n,a,r){var c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.constructMessage(t,n,a),e.abrupt("return",this._web3.eth.personal.sign("0x".concat(c.toString("hex")),r,""));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"isValidSignature",value:function(t,n,a,r,c){var s=e.prefixed(this.constructMessage(t,n,a));return e.recoverSigner(s,r).toLowerCase()===Object(je.stripHexPrefix)(c).toLowerCase()}},{key:"constructMessage",value:function(e,t,n){return Object(pe.soliditySHA3)(["address","uint256","uint256","address"],[e,t,n,this._contractAddress])}}],[{key:"prefixed",value:function(e){return Object(pe.soliditySHA3)(["string","bytes32"],["\x19Ethereum Signed Message:\n32","0x".concat(e.toString("hex"))])}},{key:"recoverSigner",value:function(e,t){var n=Object(je.fromRpcSig)(t),a=Object(je.ecrecover)(e,n.v,n.r,n.s);return Object(je.pubToAddress)(a).toString("hex")}}]),e}(),me=function(e){var t,n,r=K(),c=_().web3,s=Object(a.useState)(),i=Object(x.a)(s,2),o=i[0],d=i[1],u=Object(a.useState)(""),l=Object(x.a)(u,2),j=l[0],p=l[1],b=Object(a.useState)(!1),m=Object(x.a)(b,2),h=m[0],O=m[1];Object(a.useEffect)((function(){var e=function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return e.t0=p,e.next=5,o.getBalance();case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[o]),Object(a.useEffect)((function(){c&&r&&e.data.location&&d(new Q(c,X.a,e.data.location,r))}),[e.data,c,r]);var C=function(){var t=Object(y.a)(v.a.mark((function t(n){var a,s,i,o,d,u,l;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.data.location,n.preventDefault(),O(!0),s=Object.fromEntries(new FormData(n.target)),i=s.targetAddress,o=s.allowedAmount,d=new be(c,a),u=Date.now(),t.next=9,d.signTransaction(i,Object(S.toWei)(o),u,r);case 9:l=t.sent,e.onSignConfirm({amount:o,claimerAddress:i,nonce:u,signature:l,contractAddress:a}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:O(!1);case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}();return Object(f.jsxs)(w.a,{id:"contract-details",border:"dark",bg:"light",children:[Object(f.jsxs)(w.a.Header,{className:"d-flex justify-content-between",children:[Object(f.jsx)("div",{children:"Contract Details"}),Object(f.jsx)(oe.a,{onClick:e.closeCallback})]}),Object(f.jsxs)(w.a.Body,{children:[Object(f.jsx)(w.a.Title,{children:null===(t=e.data)||void 0===t?void 0:t.name}),Object(f.jsx)(w.a.Subtitle,{className:"mb-2 text-muted",children:null===(n=e.data)||void 0===n?void 0:n.location}),Object(f.jsxs)(w.a.Text,{children:["Balance: ",Object(S.fromWei)(j)," ETH"]}),Object(f.jsx)(de.a,{defaultActiveKey:"0",children:Object(f.jsx)(k.a,{onSubmit:C,children:Object(f.jsxs)(de.a.Item,{eventKey:"0",children:[Object(f.jsx)(de.a.Header,{children:"Sign a payment order"}),Object(f.jsxs)(de.a.Body,{children:[Object(f.jsx)(T.a,{label:"Claimer Address",className:"mb-3",children:Object(f.jsx)(M.a,{name:"targetAddress",placeholder:"0x0...",required:!0})}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(M.a,{name:"allowedAmount",placeholder:"0.0000",required:!0}),Object(f.jsx)(A.a.Text,{children:"ETH"})]}),Object(f.jsx)(te,{type:"submit",showLoader:h,children:"\xa0Generate Signature\xa0"})]})]})})})]}),Object(f.jsxs)(w.a.Footer,{className:"d-flex justify-content-end",children:[Object(f.jsx)(ue.a,{placement:"left",overlay:Object(f.jsx)(le.a,{id:"money-tooltip",children:"Deposit funds"}),children:Object(f.jsx)(g.a,{className:"icon-button",variant:"dark",onClick:e.onDeposit,children:Object(f.jsx)(ce.b,{})})}),Object(f.jsx)(ue.a,{placement:"top",overlay:Object(f.jsx)(le.a,{id:"trash-tooltip",children:"Destroy this contract"}),children:Object(f.jsx)(g.a,{className:"icon-button",variant:"danger",onClick:function(){var t;return e.onDelete(null===(t=e.data)||void 0===t?void 0:t.location)},children:Object(f.jsx)(ce.d,{})})})]})]})},fe=function(e){return Object(f.jsxs)(C.a,{show:e.show,onHide:e.onClose,centered:!0,backdrop:"static",children:[Object(f.jsx)(C.a.Header,{closeButton:!0,children:Object(f.jsx)(C.a.Title,{children:"Signature details"})}),Object(f.jsxs)(C.a.Body,{children:[Object(f.jsxs)("p",{style:{color:"red"},children:["Make sure to ",Object(f.jsx)("b",{children:"copy all these values before closing this modal"}),". You won't be able to get them again."]}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(A.a.Text,{children:"Allowed Address"}),Object(f.jsx)(M.a,{"aria-label":"Adress allowed to make the claim",placeholder:"0x0",disabled:!0,value:e.claimInfo.claimerAddress}),Object(f.jsx)(g.a,{className:"form-button",variant:"outline-dark",children:Object(f.jsx)(ce.a,{})})]}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(A.a.Text,{children:"Contract Address"}),Object(f.jsx)(M.a,{"aria-label":"Contract Adress where to make the the claim",placeholder:"0x0",disabled:!0,value:e.claimInfo.contractAddress}),Object(f.jsx)(g.a,{className:"form-button",variant:"outline-dark",children:Object(f.jsx)(ce.a,{})})]}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(A.a.Text,{children:"Allowed Amount"}),Object(f.jsx)(M.a,{"aria-label":"Allowed amount to claim in eth",placeholder:"0.0000",disabled:!0,value:e.claimInfo.amount}),Object(f.jsx)(g.a,{className:"form-button",variant:"outline-dark",children:Object(f.jsx)(ce.a,{})})]}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(A.a.Text,{children:"Nonce"}),Object(f.jsx)(M.a,{"aria-label":"Unique nonce for claim order",placeholder:"0",disabled:!0,value:e.claimInfo.nonce}),Object(f.jsx)(g.a,{className:"form-button",variant:"outline-dark",children:Object(f.jsx)(ce.a,{})})]}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(A.a.Text,{children:"Signature"}),Object(f.jsx)(M.a,{"aria-label":"Generated signature hash",placeholder:"0x0",disabled:!0,value:e.claimInfo.signature}),Object(f.jsx)(g.a,{className:"form-button",variant:"outline-dark",children:Object(f.jsx)(ce.a,{})})]})]})]})};!function(e){e.Locked="Locked",e.Connected="Connected"}(ne||(ne={}));var he=function(){var e=Object(a.useState)({amount:"0",claimerAddress:"0x0",contractAddress:"0x0",nonce:0,signature:"0x0"}),t=Object(x.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)({location:"0x0",name:""}),i=Object(x.a)(s,2),o=i[0],d=i[1],u=Object(a.useState)([]),l=Object(x.a)(u,2),j=l[0],p=l[1],b=Object(a.useState)(ne.Locked),m=Object(x.a)(b,2),h=m[0],O=m[1],w=Object(a.useState)(!1),N=Object(x.a)(w,2),D=N[0],P=N[1],B=Object(a.useState)(!1),E=Object(x.a)(B,2),I=E[0],L=E[1],H=Object(a.useState)(!1),F=Object(x.a)(H,2),_=F[0],q=F[1],U=Object(a.useState)(!1),W=Object(x.a)(U,2),Y=W[0],z=W[1],R=Object(a.useState)(!1),Q=Object(x.a)(R,2),X=Q[0],Z=Q[1],$=G(),ee=K(),ae=function(){var e=r.a.useContext(J);if(void 0===e)throw new Error("useContractFactoryContext must be used within an SmartContractContextProvider");return e}(),se=Object(a.useCallback)(Object(y.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.getMicropaymentsContracts();case 2:t=e.sent,p(t);case 4:case"end":return e.stop()}}),e)}))),[ae]);Object(a.useEffect)((function(){h===ne.Connected&&se()}),[se,h]),Object(a.useEffect)((function(){var e=function(){var e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ee&&ae){e.next=4;break}return z(!1),O(ne.Locked),e.abrupt("return");case 4:return e.next=6,ae.isOwner(ee);case 6:if(e.sent){e.next=10;break}return z(!0),O(ne.Locked),e.abrupt("return");case 10:ae.updateUserAccount(ee),ae.onMicropaymentsCreated(ee,(function(){Z(!1),L(!1),se()})),z(!1),O(ne.Connected);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[ee,ae,se]);var oe=function(){var e=Object(y.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae.deleteContract(t);case 2:P(!1),se();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(y.a)(v.a.mark((function e(t){var n,a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),Z(!0),n=Object.fromEntries(new FormData(t.target)),a=n.name,r=n.value,e.next=6,ae.createMicropayment(a,Object(S.toWei)(r));case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),Z(!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{id:"company",children:[Object(f.jsxs)("div",{className:"content",children:[Object(f.jsxs)("div",{className:"table-container",children:[Object(f.jsx)("div",{className:"actions-container",children:Object(f.jsxs)(g.a,{variant:"primary",className:"d-flex justify-content-center align-items-center",onClick:function(){L(!0)},children:[Object(f.jsx)(ce.c,{}),Object(f.jsx)("div",{children:"Create a Contract"})]})}),Object(f.jsx)(ie,{contractData:j,rowSelectedCallback:function(e){d(e),P(!0)}})]}),D&&Object(f.jsx)("div",{id:"contract-side-card",children:Object(f.jsx)(me,{closeCallback:function(){return P(!1)},onSignConfirm:function(e){c(e),q(!0)},onDeposit:function(){console.error("deposit eth to this contract is not yet implemented")},onDelete:oe,data:o})})]}),Object(f.jsxs)(C.a,{show:h===ne.Locked,centered:!0,children:[Object(f.jsxs)(C.a.Body,{className:"text-center",children:[Object(f.jsx)("div",{children:"Please, connnect your wallet to continue."}),Y?Object(f.jsx)(re.a,{className:"d-inline-block m-1",bg:"danger",children:Object(f.jsx)(re.a.Body,{children:Object(f.jsx)("strong",{children:"Your are not the owner of this company, please select another account."})})}):null]}),!Y&&Object(f.jsx)(C.a.Footer,{className:"d-flex justify-content-center",children:Object(f.jsxs)(g.a,{variant:"primary",onClick:$,className:"d-flex",children:[Object(f.jsx)(V,{}),Object(f.jsx)("div",{children:"Connect with MetaMask"})]})})]}),Object(f.jsx)(C.a,{show:I,onHide:function(){return L(!1)},centered:!0,children:Object(f.jsxs)(k.a,{onSubmit:de,children:[Object(f.jsx)(C.a.Header,{closeButton:!0,children:Object(f.jsx)(C.a.Title,{children:"New Contract"})}),Object(f.jsxs)(C.a.Body,{children:[Object(f.jsx)(T.a,{label:"Contract Name",className:"mb-3",children:Object(f.jsx)(M.a,{name:"name",placeholder:"choose a name...",required:!0})}),Object(f.jsxs)(A.a,{className:"mb-3",children:[Object(f.jsx)(M.a,{name:"value",placeholder:"0.0000",required:!0}),Object(f.jsx)(A.a.Text,{children:"ETH"})]})]}),Object(f.jsx)(C.a.Footer,{children:Object(f.jsx)(te,{type:"submit",showLoader:X,children:"\xa0Confirm\xa0"})})]})}),Object(f.jsx)(fe,{claimInfo:n,show:_,onClose:function(){return q(!1)}})]})},ye=function(){return Object(f.jsx)("div",{className:"app",children:Object(f.jsx)(i.a,{children:Object(f.jsxs)(o.c,{children:[Object(f.jsx)(o.a,{path:"/",element:Object(f.jsx)(h,{})}),Object(f.jsx)(o.a,{path:"/contractor",element:Object(f.jsx)(ae,{})}),Object(f.jsx)(o.a,{path:"/company",element:Object(f.jsx)(he,{})})]})})})},xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,650)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(z,{children:Object(f.jsx)(ye,{})})}),document.getElementById("root")),xe()}},[[626,1,2]]]);
//# sourceMappingURL=main.886161b1.chunk.js.map